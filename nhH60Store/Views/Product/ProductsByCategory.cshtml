@model IEnumerable<nhH60Store.Models.Product>

<main id="producstByCategory">

    <h2 class="page-title">Products Listed by Category</h2>

    <a title="Go Back" class="btn btn-secondary" href="@Url.Action("Index", "Product")">Go Back</a>

    <div class="messages">
        @if (TempData["ErrorMessage"] != null) {
            <div class="alert alert-danger" role="alert">
                @TempData["ErrorMessage"]
            </div>
        }

    </div>

    <div class="messages">
        @if (TempData["SuccessMessage"] != null) {
            <div class="alert alert-success" role="alert">
                @TempData["SuccessMessage"]
            </div>
        }
    </div>

    @{ decimal currentCategory = 0; }

    @if (Model.Count() == 0) {

        <p>Sorry, no products for this category yet.</p>

    } else {

        <div id="productsWithCategories">
            @foreach (var x in Model) {
                @if (x.ProdCatId != currentCategory) {
                    currentCategory = x.ProdCatId;
                    <h4 class="categorySubTitle">@x.ProdCat.ProdCat</h4>
                    @await Html.PartialAsync("_Products", x)
                } else {
                    @await Html.PartialAsync("_Products", x)
                }
            }
        </div>
    }

</main>